(function(e){function t(t){for(var a,i,s=t[0],c=t[1],u=t[2],l=0,h=[];l<s.length;l++)i=s[l],Object.prototype.hasOwnProperty.call(o,i)&&o[i]&&h.push(o[i][0]),o[i]=0;for(a in c)Object.prototype.hasOwnProperty.call(c,a)&&(e[a]=c[a]);p&&p(t);while(h.length)h.shift()();return r.push.apply(r,u||[]),n()}function n(){for(var e,t=0;t<r.length;t++){for(var n=r[t],a=!0,i=1;i<n.length;i++){var c=n[i];0!==o[c]&&(a=!1)}a&&(r.splice(t--,1),e=s(s.s=n[0]))}return e}var a={},o={app:0},r=[];function i(e){return s.p+"js/"+({canvg:"canvg",pdfmake:"pdfmake",xlsx:"xlsx"}[e]||e)+"."+{canvg:"34a37dd1",pdfmake:"b17ba0e4",xlsx:"59fa7f36"}[e]+".js"}function s(t){if(a[t])return a[t].exports;var n=a[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.e=function(e){var t=[],n=o[e];if(0!==n)if(n)t.push(n[2]);else{var a=new Promise((function(t,a){n=o[e]=[t,a]}));t.push(n[2]=a);var r,c=document.createElement("script");c.charset="utf-8",c.timeout=120,s.nc&&c.setAttribute("nonce",s.nc),c.src=i(e);var u=new Error;r=function(t){c.onerror=c.onload=null,clearTimeout(l);var n=o[e];if(0!==n){if(n){var a=t&&("load"===t.type?"missing":t.type),r=t&&t.target&&t.target.src;u.message="Loading chunk "+e+" failed.\n("+a+": "+r+")",u.name="ChunkLoadError",u.type=a,u.request=r,n[1](u)}o[e]=void 0}};var l=setTimeout((function(){r({type:"timeout",target:c})}),12e4);c.onerror=c.onload=r,document.head.appendChild(c)}return Promise.all(t)},s.m=e,s.c=a,s.d=function(e,t,n){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)s.d(n,a,function(t){return e[t]}.bind(null,a));return n},s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="/",s.oe=function(e){throw console.error(e),e};var c=window["webpackJsonp"]=window["webpackJsonp"]||[],u=c.push.bind(c);c.push=t,c=c.slice();for(var l=0;l<c.length;l++)t(c[l]);var p=u;r.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"56d7":function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cfa"),n("cca6"),n("a79d");var a=n("2b0e"),o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-app",[n("router-view")],1)},r=[],i={name:"App"},s=i,c=n("2877"),u=n("6544"),l=n.n(u),p=n("7496"),h=Object(c["a"])(s,o,r,!1,null,null,null),d=h.exports;l()(h,{VApp:p["a"]});var f=n("8c4f"),m=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("map-moscow")],1)},g=[],v=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"moscow-map"},[n("div",{ref:"chartdiv",staticClass:"moscow-map__chart"}),n("v-btn",{staticClass:"moscow-map__refresh_button",on:{click:function(t){return e.generateRandomPoints(100)}}},[e._v("Сгенерировать")]),n("div",{staticClass:"moscow-map__map",attrs:{id:"map"}})],1)},y=[],b=(n("4160"),n("d81d"),n("fb6a"),n("b0c0"),n("4ec9"),n("b680"),n("d3b7"),n("3ca3"),n("159b"),n("ddb0"),n("b85c")),w=(n("96cf"),n("1da1")),x=n("bc3a"),j=n("d4ec"),O=n("bee2"),k=function(){function e(t,n){Object(j["a"])(this,e),this.name=t,this.region=n,this.map=n.map,this.geo=new ymaps.Placemark(t,{balloonContent:this.name},{preset:"islands#dotIcon",iconColor:"#3caa3c"})}return Object(O["a"])(e,[{key:"display",value:function(){this.map.geoObjects.add(this.geo)}},{key:"hide",value:function(){this.map.geoObjects.remove(this.geo)}}]),e}(),P=function(){function e(t,n){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t.geometry;Object(j["a"])(this,e),this.name=t.properties.NAME,this.color=t.options.fillColor,this.map=n,this.coords=a.coordinates,this.weight=null,this.points=[],this.geo=new ymaps.GeoObject({geometry:a,properties:t.properties},{fillColor:t.options.fillColor,strokeColor:"#414141",opacity:.5,strokeWidth:2,strokeStyle:"solid"}),this.maxX=0,this.maxY=0,this.minX=100,this.minY=100,this.limits()}return Object(O["a"])(e,[{key:"contains",value:function(e){return this.geo.geometry.contains(e)}},{key:"display",value:function(){this.map.geoObjects.add(this.geo)}},{key:"hide",value:function(){this.map.geoObjects.remove(this.geo)}},{key:"limits",value:function(){var e=this;this.coords.forEach((function(t){t.forEach((function(t){t[0]>e.maxX?e.maxX=t[0]:t[0]<e.minX&&(e.minX=t[0]),t[1]>e.maxY?e.maxY=t[1]:t[1]<e.minY&&(e.minY=t[1])}))})),this.weight=((this.maxX-this.minX)*(this.maxY-this.minY)*1e3).toFixed(5)}},{key:"generateRandomPoint",value:function(){var e=!1;while(!1===e){var t=(Math.random()*(this.maxX-this.minX)+this.minX).toFixed(5),n=(Math.random()*(this.maxY-this.minY)+this.minY).toFixed(5);if(this.contains([t,n])){e=!0;var a=new k([t,n],this);this.points.push(a),a.display()}}}},{key:"clearPoints",value:function(){this.points.forEach((function(e){e.hide()})),this.points=[]}}]),e}(),E=n("71c9"),M=n("c497"),_=(n("5a54"),{name:"MapMoscow",data:function(){return{map:null,regionsJson:null,regions:[],loading:!1,chartData:[],activeSliceName:null}},methods:{yandexMapsInitialization:function(){this.map=new ymaps.Map("map",{center:[37.64,55.76],zoom:10}),this.map.layers.add(new ymaps.Layer("http://tile.openstreetmap.org/%z/%x/%y.png",{projection:ymaps.projection.sphericalMercator})),this.map.copyrights.add("&copy; OpenStreetMap contributors, CC-BY-SA")},getRegionsJson:function(){var e=this;return Object(w["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,x["get"]("https://api.jsonbin.io/b/5f5c0870ad23b57ef9107157/8",{headers:{"secret-key":"$2b$10$f80fXx031oddADsAPOtLbOfaINvWiQ8TIeHrK.dl4QnE6CTKyFKgG"}});case 2:n=t.sent,e.regionsJson=n.data,e.GeoJsonHandler();case 5:case"end":return t.stop()}}),t)})))()},GeoJsonHandler:function(){var e=this;this.regionsJson.features.forEach((function(t){if("Polygon"===t.geometry.type){var n=new P(t,e.map);e.regions.push(n),n.display()}else"MultiPolygon"===t.geometry.type&&t.geometry.coordinates.forEach((function(n){return e.addMultiPolygonPartToMap(n,t)}))})),this.generateRandomPoints(100)},addMultiPolygonPartToMap:function(e,t){var n=new P(t,this.map,{type:"Polygon",coordinates:e});this.regions.push(n),n.display()},clearAllPoints:function(){this.regions.forEach((function(e){e.clearPoints()}))},generateRandomPoints:function(e){this.clearAllPoints();var t=0,n=0;this.regions.forEach((function(e){e.display(),e.rangeFrom=n.toFixed(5),n+=parseFloat(e.weight),e.rangeTo=n.toFixed(5)}));while(t<=e){var a=(Math.random()*n).toFixed(5);this.regions.forEach((function(e){a<=e.rangeTo&&a>e.rangeFrom&&e.generateRandomPoint()})),t++}console.log("111"),this.generateChartData()},generateChartData:function(){var e=[],t=new Map;this.regions.forEach((function(e){if(t.has(e.name)){var n=t.get(e.name);n.points+=e.points.length,t.set(e.name,n)}else console.log(e.color),t.set(e.name,{region:e.name,points:e.points.length,color:e.color})}));var n,a=Object(b["a"])(t.values());try{for(a.s();!(n=a.n()).done;){var o=n.value;e.push(o)}}catch(r){a.e(r)}finally{a.f()}this.chartData=e,this.chartHandler()},chartHandler:function(){var e=E["a"](this.$refs.chartdiv,M["b"]);e.hiddenState.properties.opacity=0,e.data=this.chartData,e.innerRadius=E["b"](40),e.depth=120,e.legend=new M["a"];var t=e.series.push(new M["c"]);t.dataFields.value="points",t.dataFields.depthValue="points",t.dataFields.category="region",t.slices.template.cornerRadius=3,t.colors.step=3,t.slices.template.events.on("hit",this.sliceClickHandler)},sliceClickHandler:function(e){var t=this,n=e.target.slice.dataItem._dataContext.region;n!==this.activeSliceName?this.regions.forEach((function(e){e.name!==n?(e.hide(),e.points.forEach((function(e){e.hide()}))):(t.activeSliceName=n,e.display(),e.points.forEach((function(e){e.display()})))})):this.regions.forEach((function(e){e.display(),e.points.forEach((function(e){e.display()}))}))}},created:function(){var e=this;return Object(w["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.getRegionsJson();case 2:case"end":return t.stop()}}),t)})))()},mounted:function(){var e=this;return Object(w["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,ymaps.ready(e.yandexMapsInitialization);case 2:case"end":return t.stop()}}),t)})))()},beforeDestroy:function(){this.chart&&this.chart.dispose()}}),C=_,R=(n("d5e5"),n("8336")),F=Object(c["a"])(C,v,y,!1,null,"5a4d7986",null),S=F.exports;l()(F,{VBtn:R["a"]});var X={name:"Home",components:{"map-moscow":S}},Y=X,T=Object(c["a"])(Y,m,g,!1,null,null,null),A=T.exports;a["a"].use(f["a"]);var H=[{path:"/",name:"Home",component:A}],J=new f["a"]({mode:"history",base:"/",routes:H}),$=J,D=n("2f62");a["a"].use(D["a"]);var I=new D["a"].Store({state:{},mutations:{},actions:{},modules:{}}),N=n("f309");a["a"].use(N["a"]);var z=new N["a"]({});a["a"].config.productionTip=!1,new a["a"]({router:$,store:I,vuetify:z,render:function(e){return e(d)}}).$mount("#app")},8105:function(e,t,n){},d5e5:function(e,t,n){"use strict";var a=n("8105"),o=n.n(a);o.a}});
//# sourceMappingURL=app.c7fb1582.js.map